import whois
import typer
import nmap3


"""Command line for doing whois lookups"""

app = typer.Typer()

@app.command()
def domain(name: str):
    """Performs a whois lookup"""
    results = whois.whois(name)
    print(f"{name} is registered by {results.registrar} - {results.org}")

@app.command()
def portscanner(target: str, top: int=10):
    """Performs a portscan against the top 10 Ports"""
    nmap = nmap3.Nmap()
    results = nmap.scan_top_ports(target, default=top)
    ip, *_unused = results.keys()
    for port in results[ip]['ports']:
        if 'open' in port['state']:
            print(f"{port['portid']} {port['service']['name']}")

if __name__ == "__main__":
    app()
